nout = 20
timestep = 1000

MYG = 0  # No guard cells in Y, 2D simulation

[mesh]
nx = 36
ny = 1
nz = 32

Lrad = 0.05  # Radial width of domain [m]
Lpol = 0.05  # Poloidal size of domain [m]

Bpxy = 0.35  # Poloidal magnetic field [T]
Rxy = 1.5   # Major radius [meters]

dx = Lrad * Rxy * Bpxy / (nx - 4)  # Poloidal flux
dz = Lpol / Rxy / nz   # Angle

hthe = 1
sinty = 0
Bxy = Bpxy
Btxy = 0
bxcvz = 1./Rxy^2  # Curvature

[solver]
mxstep = 10000

[hermes]
# Two species, electrons and ions
components = e, h+, vorticity, polarisation_drift

recalculate_metric = true  # Calculate metrics from Rxy, Bpxy etc.

Nnorm = 2e18
Bnorm = mesh:Bxy
Tnorm = 5

[e]
type = evolve_density, evolve_pressure

charge = -1
AA = 1/1836

poloidal_flows = false  # Y flows due to ExB
thermal_conduction = false  # Parallel heat conduction

[Ne]

function = 1

bndry_all = neumann

[Pe]
function = 1 + 0.1 * sin(2*pi*x - z)
bndry_all = neumann

[h+]
# Set the density so that the plasma is quasineutral
type = quasineutral, evolve_pressure

charge = 1
AA = 1

bndry_flux = true
poloidal_flows = false
thermal_conduction = false

[Ph+]
function = Pe:function
bndry_all = neumann

[vorticity]

diamagnetic = true   # Include diamagnetic current?
diamagnetic_polarisation = true # Include diamagnetic drift in polarisation current?
average_atomic_mass = 1.0   # Weighted average atomic mass, for polarisaion current
bndry_flux = false # Allow flows through radial boundaries
poloidal_flows = false  # Include poloidal ExB flow
split_n0 = false  # Split phi into n=0 and n!=0 components
phi_dissipation = false

phi_boundary_relax = true

phi_dissipation = false # No parallel dynamics

viscosity = 1.0

diagnose = false

[polarisation_drift]
diamagnetic_polarisation = vorticity:diamagnetic_polarisation
advection = false
average_atomic_mass = vorticity:average_atomic_mass
diagnose = false

